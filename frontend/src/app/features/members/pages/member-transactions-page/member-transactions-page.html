<section class="card fade-in">
  <h1>Member Transactions</h1>
  <p class="muted">All escrow-backed payments and related activity.</p>

  <div class="metrics">
    <div class="metric">
      <div class="value">{{ totalCount }}</div>
      <div class="label">Transactions</div>
    </div>
    <div class="metric">
      <div class="value">R{{ totalGross.toLocaleString() }}</div>
      <div class="label">Total Funded</div>
    </div>
    <div class="metric">
      <div class="value">R{{ totalNet.toLocaleString() }}</div>
      <div class="label">Net Released</div>
    </div>
  </div>

  <div class="table">
    <div class="row head">
      <div>Job</div><div>Status</div><div>Gross</div><div>Net</div><div>Last Update</div><div>Supplier</div><div></div>
    </div>
    <div class="row" *ngFor="let r of rows">
      <div class="job">{{ r.jobTitle }}</div>
      <div>
        <span class="badge" [ngClass]="{ accepted: r.status === 'released' }">{{ r.statusLabel }}</span>
      </div>
      <div>R{{ r.gross.toLocaleString() }}</div>
      <div>R{{ r.net.toLocaleString() }}</div>
      <div>{{ r.lastWhen || 'â€”' }}</div>
      <div class="supplier-cell">
        <div class="supplier-name" *ngIf="r.supplierName; else noSupplier">
          {{ r.supplierName }}
        </div>
        <ng-template #noSupplier>
          <span class="muted">No supplier</span>
        </ng-template>
        <div class="supplier-meta" *ngIf="r.supplierStatus || r.complianceLabel">
          <span class="chip chip-status" *ngIf="r.supplierStatus">
            {{ r.supplierStatus }}
          </span>
          <span class="chip chip-compliance" *ngIf="r.complianceLabel">
            {{ r.complianceLabel }}
          </span>
        </div>
      </div>
      <div><a class="link" [routerLink]="['/member/transactions', r.id]">View</a></div>
    </div>
    <div class="muted" *ngIf="rows.length === 0">No transactions yet</div>
  </div>
</section>
