<section class="card">
  <h1>Create Procurement Request</h1>
  <p>Submit a detailed procurement request so verified suppliers can bid.</p>

  <form class="form">
    <label>
      Category
      <select name="category" [(ngModel)]="category">
        <option>Uniforms &amp; PPE</option>
        <option>SIM Cards &amp; Connectivity</option>
        <option>Access Control Systems</option>
        <option>Patrol Monitoring Systems</option>
        <option>Two-Way Radios</option>
        <option>Financial Assistance &amp; Asset Finance</option>
        <option>Insurance Solutions</option>
      </select>
    </label>

    <label>
      Product / Service Description
      <textarea
        name="requirements"
        [(ngModel)]="requirements"
        rows="4"
        placeholder="Describe the product or service you need, scope, and key requirements."
      ></textarea>
    </label>

    <label>
      Delivery Location
      <input
        name="location"
        [(ngModel)]="location"
        type="text"
        placeholder="e.g. Johannesburg, Gauteng"
      />
    </label>

    <label>
      Required Certifications
      <input name="requiredCerts" [(ngModel)]="requiredCertsText" type="text" placeholder="e.g. PSIRA, Firearm, First Aid" />
      <small class="muted">Comma-separated list</small>
    </label>

    <div class="grid">
      <label>
        Quantity
        <input name="quantity" [(ngModel)]="quantity" type="number" placeholder="e.g. 50" />
      </label>
      <label>
        Min budget
        <input name="minBudget" [(ngModel)]="minBudget" type="number" placeholder="e.g. 20000" />
      </label>
      <label>
        Max budget
        <input name="maxBudget" [(ngModel)]="maxBudget" type="number" placeholder="e.g. 40000" />
      </label>
    </div>

    <label>
      Bid deadline
      <input name="bidDeadline" [(ngModel)]="bidDeadline" type="date" />
    </label>

    <div class="grid">
      <label>
        Start date
        <input name="startDate" [(ngModel)]="startDate" type="date" />
      </label>
      <label>
        End date
        <input name="endDate" [(ngModel)]="endDate" type="date" />
      </label>
      <label>
        Duration (days)
        <input
          name="durationDays"
          [(ngModel)]="durationDays"
          type="number"
          placeholder="e.g. 3"
        />
      </label>
    </div>

    <label>
      Attachments
      <input type="file" (change)="onFilesSelected($event.target.files)" multiple />
    </label>

    <div class="errors">
      <div *ngIf="requirements.trim().length === 0">Description is required.</div>
      <div *ngIf="location.trim().length === 0">Delivery location is required.</div>
      <div *ngIf="!minBudget || !maxBudget">Budget range is required.</div>
      <div *ngIf="minBudget && maxBudget && minBudget > maxBudget">Min budget must be less than or equal to max budget.</div>
      <div *ngIf="!quantity || quantity <= 0">Quantity is required.</div>
      <div *ngIf="!bidDeadline">Bid deadline is required.</div>
      <div *ngIf="deadlineInPast">Bid deadline must be a future date.</div>
      <div *ngIf="datesInvalid">Start date must be before end date.</div>
      <div *ngIf="attachments.length === 0">At least one attachment is required.</div>
    </div>

    <button type="button" [disabled]="!isValid" (click)="publish()">Create Request</button>
  </form>

  <div class="toast success" *ngIf="submitted">
    Request published successfully
  </div>
</section>
