<section class="card suppliers-page">
  <h1>Suppliers</h1>
  <div class="subtabs">
    <a routerLink="/admin/users/members" routerLinkActive="active">Members</a>
    <a routerLink="/admin/users/suppliers" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Suppliers</a>
    <a routerLink="/admin/users/admins" routerLinkActive="active">Admins</a>
  </div>
  
  <div class="filters">
    <input type="text" [(ngModel)]="query" placeholder="Search by name, email or company" />
    <div class="muted">{{ filtered.length }} results</div>
  </div>
  
  <div class="table">
    <div class="row head">
      <div>Name</div>
      <div>Company</div>
      <div>Email</div>
      <div>Joined</div>
      <div>Status</div>
      <div></div>
    </div>
    <div class="row" *ngFor="let r of filtered">
      <div [attr.data-label]="'Name'">{{ r.name }}</div>
      <div [attr.data-label]="'Company'">{{ r.company || 'â€”' }}</div>
      <div [attr.data-label]="'Email'">{{ r.email }}</div>
      <div [attr.data-label]="'Joined'">{{ r.createdAt | date: 'mediumDate' }}</div>
      <div [attr.data-label]="'Status'">
        <span class="badge" [ngClass]="statusClass(r.status)">{{ r.status || 'Pending' }}</span>
      </div>
      <div [attr.data-label]="'Actions'">
        <div class="user-actions">
          <button type="button" class="icon-btn accept" (click)="setStatus(r.id, 'Approved')" title="Approve">
            <i class="bi bi-check-lg"></i>
          </button>
          <button type="button" class="icon-btn reject" (click)="openReject(r.id)" title="Reject">
            <i class="bi bi-x-lg"></i>
          </button>
          <button type="button" class="icon-btn view" (click)="view(r.id)" title="View Details">
            <i class="bi bi-eye"></i>
          </button>
        </div>
      </div>
    </div>
    <div class="muted" *ngIf="filtered.length===0">No suppliers found</div>
  </div>

  <!-- Rejection Modal -->
  <div class="modal-backdrop" *ngIf="rejectingId">
    <div class="modal">
      <h3>Reject Supplier</h3>
      <p class="muted">Provide a reason. The supplier will see this on their side.</p>
      <textarea
        [(ngModel)]="rejectReason"
        rows="4"
        placeholder="Type rejection reason..."
      ></textarea>
      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="closeReject()">Cancel</button>
        <button
          type="button"
          class="btn-danger"
          [disabled]="!rejectReason.trim()"
          (click)="confirmReject()"
        >
          Reject Supplier
        </button>
      </div>
    </div>
  </div>
</section>